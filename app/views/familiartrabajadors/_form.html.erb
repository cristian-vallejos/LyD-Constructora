<link href='<%= asset_url("css/bootstrap.min.css") %>' rel="stylesheet" type="text/css">
<link href='<%= asset_url("css/font-awesome.min.css") %>' rel="stylesheet">
<link href='<%= asset_url("css/style-273.css") %>' rel="stylesheet">
<link rel="shortcut icon" href="#">
<link href='<%= asset_url("css2/stylesLD.css") %>' rel="stylesheet" type="text/css">

<% if params[:trab_rut_err] && params[:trab_rut_err] == "true" %>
  <div id="error_explanation">
    <h2>Error:</h2>
    <ul>
      <li>El rut del trabajador es inválido.</li>
    </ul>
  </div>
<% elsif params[:fam_rut_err] && params[:fam_rut_err] == "true" %>
  <div id="error_explanation">
    <h2>Error:</h2>
    <ul>
      <li>El rut del familiar es inválido.</li>
    </ul>
  </div>
<% elsif params[:fam_rut_err] && params[:fam_rut_err] == "true" && params[:trab_rut_err] && params[:trab_rut_err] == "true" %>
  <div id="error_explanation">
    <h2>Error:</h2>
    <ul>
      <li>Ambos ruts ingresados son inválidos.</li>
    </ul>
  </div>
<% end %>

<%= form_with(model: familiartrabajador, local: true) do |form| %>
  <% if familiartrabajador.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(familiartrabajador.errors.count, "error") %> prohibited this familiartrabajador from being saved:</h2>

      <ul>
      <% familiartrabajador.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

<div class="container">
    <div class="content">
      <div>
        <div align="center" style="box-shadow:0px 0px 15px rgba(0,0,0,0.1);">
            <div class="field">
              <%= form.label :rut, "RUT Familiar" %><br>
              <%= form.text_field :rut, id: :familiartrabajador_rut, required: true %> <br>
            </div>

            <div class="field">
              <%= form.label :nombre, "Nombre del Familiar" %><br>
              <%= form.text_field :nombre, id: :familiartrabajador_nombre, required: true %><br>
            </div>

            <div class="field">
              <%= form.label :relacion %><br>
              <%= form.select :relacion, [["", ""], ["Hermano(a)", "Hermano(a)"], ["Hijo(a)", "Hijo(a)"], ["Cónyuge", "Cónyuge"], ["Conviviente", "Conviviente"], ["Padre", "Padre"], ["Madre", "Madre"]], id: :familiartrabajador_relacion, required: true %><br>
            </div>

            <div class="field">
              <%= form.label :fechanacimiento, "Fecha de Nacimiento" %><br>
              <%= form.date_select :fechanacimiento, id: :familiartrabajador_fechanacimiento, start_year: 1900, required: true %><br>
            </div>

            <div class="field">
            <%= form.label :rut_trabajador, "RUT Trabajador" %>
              <% if params[:rut_trabajador] %>
                <%= form.text_field :rut_trabajador, id: :familiartrabajador_rut_trabajador, value: params[:rut_trabajador], hidden: true %><br>
                <%= params[:rut_trabajador] %>
              <% else %>
                <br>
                <%= form.text_field :rut_trabajador, id: :familiartrabajador_rut_trabajador, required: true %><br>
              <% end %>
            </div>

            <div class="field">
            <%= form.label :nombre_trabajador, "Nombre Trabajador" %>
              <% if params[:rut_trabajador] %>
                <%= form.text_field :nombre_trabajador, id: :familiartrabajador_nombre_trabajador, value: Employee.find_by(rut: params[:rut_trabajador]).nombre, hidden: true %><br>
                <%= Employee.find_by(rut: params[:rut_trabajador]).nombre %>
              <% else %>
                <br>
                <%= form.text_field :nombre_trabajador, id: :familiartrabajador_nombre_trabajador, required: true %><br>
              <% end %>
            </div>

            <div class="actions">
              <%= form.submit "Guardar Familiar", :class => "btn btn-green btn-lg btn-block" %>
            </div>


        </div>
      </div>
    </div>
  </div>




<% end %>
